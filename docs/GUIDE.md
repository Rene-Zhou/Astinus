# Astinus 项目开发参考

Astinus（阿斯特纽斯）是一个 AI 驱动的叙事导向的类 ttrpg 游戏，旨在利用 AI multi-agnet 架构，提供
叙事主义（narrativism）的单人ttrpg体验。

## 1. 核心设计原则

| 原则 | 说明 |
|------|------|
| **纯自然语言** | 无选项菜单（A攻击，B逃跑），玩家用自己的话行动，AI 理解意图并推进 |
| **上下文隔离** | 每个 NPC 只知道自己该知道的事，不同的 agent 上下文隔离，由 GM agnet 统筹 |
| **规则透明** | 骰子判定公开，玩家能理解为何成功/失败 |
| **模块化叙事** | 故事包可插拔，引擎与内容分离 |

## 2. Agent 架构

<参考 docs/guide-agnet 完成，注意和前后文的连接，例如术语的统一>

### 2.1 GM Agent

### 2.2 NPC Agnet

……

## 3. 游戏系统

游戏采用极其简单的2d6系统，没有属性值，没有专长这些元素。通过简单的系统来激发叙事的更大可能。

### 3.1 角色构成

角色构成:
  - 核心概念（一句话来对角色进行描述，例如“失业的建筑师”、“只会炼金术的法师”）
  - 一般而言，初始有 3 个特质 (Traits)
  - 每个特质都有正面和负面
  - 可以在游戏过程中获得新的特质

特质结构:

```
  name: "简短标签"
  description: "完整描述"
  positive_aspect: "这个特质如何帮助角色"
  negative_aspect: "这个特质如何阻碍角色"
```

特质示例：

```
 name: "优柔寡断"
 description: "在行动前总是会思考许多，在脑内预演所能想象到的可能性，在具体执行上往往迟疑不决"
 positive_aspect: "经常能预演各种可能性，从而提前了解到决策可能的后果，从而做出更明智的决策"
 negative_aspect: "常常因为过度思考而错过最佳时机"
```
  
### 3.2 角色状态

不通过诸如 HP 来追踪角色的状态，而是通过一系列标签（tag）来追踪角色，例如角色腿部中了一枪，那
么就给玩家一个<腿部枪伤>的 tag。不同于 trait，tag 是可以纯粹正面/负面的，例如<腿部枪伤>就会
导致玩家在例如逃跑这类的检定中获得劣势。

### 3.3 游戏检定

判定:
  1. 基础骰: 2d6
  
  2. 结果:
  
    - 10+: 强成功（success），也就是完全成功
    - 7-9: 弱成功（partial success），成功但有代价
    - 6-: 失败，故事继续
  
  3. 修正:
  
    - 优势，特质/标签正面相关: +1d6 (取最高的两个骰值，即 `/r3d6kh2`)
    - 劣势，特质/标签负面触发: -1d6 (取最低的两个骰值，即 `/r3d6kl2`)
    - 优劣可以抵消，优劣可以叠加：例如，一个“运动健将”特质+“腿部中枪”标签，可以抵消劣势；“文弱”特质+“腿部中枪”标签，则需要投4个d6,取最低的两个的加值

### 3.4 为什么这样设计

- 无属性值 → 角色创建即讲故事，不是填数字
- 双面特质 → 每个优势都带着劣势，角色更立体
- AI 友好 → 比"敏捷 vs 智力"更容易判断相关性
- 鼓励叙事 → 玩家必须解释特质如何帮助，而不是被动等结果

### 3.5 可能的改进方向

#### 边玩边建卡 (Character Creation on the Fly)

解决的痛点：角色创建时，玩家需要提前规划好所有特质，这可能会导致角色设定过于僵硬，缺乏灵活性，或是
整场游戏中都没有用到某个特质。

游戏开始时，你只填写角色的核心概念（例如“帝国逃兵”），特质留空。

在游戏中填写：当你在游戏中突然灵光一现，或者做了一件非常酷的事情时（例如你成功欺骗了守卫），你可以
当场宣布：“我要把我的第一个特质定为 ‘三寸不烂之舌’！”

为什么有效？

这保证了你写下的每一个相位都是在当前故事中已经被证明有用的。它极大地降低了建卡时的脑力负担，避免了
“想了半天设定结果游戏里根本没用到”的尴尬。

## 4. 世界包结构

<参考 [SillyTavern](https://github.com/SillyTavern/SillyTavern)，请帮我完成>

## 5. NPC构成

<参考 docs/guide-npc.md ，并用更结构性的描述完成这一段落，注意！那片文章中预设了游戏系统会涉及到HP等类dnd的ttrpg系统的数据，注意取舍>

## 6. 掷骰系统

用户应该有一个可感的掷骰过程，而且，应该只有玩家需要掷骰，GM在游戏全程不应该掷骰。当 Rule Agent 认定，当前
环节需要玩家进行掷骰，来判断是否可以成功达成目标时，应该有一个可视化的界面，显示现在掷骰的影响因素，包括已经影
响掷骰的特质/标签，和骰子的构成，是基础的2d6？还是3d6kl2？

为此，rule agent 生成的发起掷骰的请求体至少包括以下部分：

```json
  Intention: "逃离这个房间"                 # 玩家的意图
  Influencing_factor: {
    Traits: [],
    Label: ["右腿受伤"]
  }                                       # 影响检定的因素
  dices: "3d6kl2"                         # 骰子构成
  Instructions："由于右腿受伤，你在逃离这个房间的检定上有劣势"
```

额外需要注意的是，Rule agent只需要分析tags，和带来负面的traits，一个特质如何让
玩家角色在这个检定中获得优势，应该由玩家来论述。

也就是说，玩家看到掷骰界面后，除了“确认”外，也可以申请说：“我的角色有着运动健将的特质，他在受伤的情况下，应该也能克服痛苦”，如果Rule Agent觉得合理，则要修改掷骰请求：


```json
  Intention: "逃离这个房间"                 # 玩家的意图
  Influencing_factor: {
    Traits: ["运动健将"],
    Label: ["右腿受伤"]
  }                                       # 影响检定的因素
dices: "2d6"                              # 骰子构成
Instructions："虽然右腿受伤，但凭借着多年训练的毅力，你在逃离这个房间的检定上优劣势抵消了"
```
